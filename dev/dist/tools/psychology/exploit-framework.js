import { PLATFORM, IS_MOBILE } from '../../config/environment.js';
export class SecurityAwarenessFramework {
    exploitationVectors;
    platform;
    isMobile;
    constructor() {
        this.platform = PLATFORM;
        this.isMobile = IS_MOBILE;
        this.initializeExploitationVectors();
    }
    generateSecurityAwarenessReport(profile, diagnoses, crisisLevel) {
        const riskAssessment = this.assessExploitationRisk(profile, diagnoses, crisisLevel);
        const exploitationVectors = this.identifyExploitationVectors(profile, diagnoses);
        const socialEngineeringPlan = this.createSocialEngineeringPlan(profile, diagnoses, exploitationVectors);
        const protectiveRecommendations = this.generateProtectiveRecommendations(profile, diagnoses, riskAssessment);
        const emergencyProtocols = this.createEmergencyProtocols(crisisLevel, riskAssessment);
        return {
            riskAssessment,
            exploitationVectors,
            socialEngineeringPlan,
            protectiveRecommendations,
            emergencyProtocols,
            disclaimer: "This report is for educational and security awareness purposes only. It demonstrates how psychological profiles could potentially be exploited by malicious actors. This information should be used ethically to protect individuals and organizations from social engineering attacks. Any misuse of this information for actual exploitation is strictly prohibited and may be illegal.",
            educationalPurpose: "This analysis helps security professionals, mental health providers, and individuals understand potential vulnerabilities and implement appropriate protective measures against social engineering attacks."
        };
    }
    assessExploitationRisk(profile, diagnoses, crisisLevel) {
        const riskFactors = [];
        let vulnerabilityScore = 0;
        let exploitationLikelihood = 0;
        // Assess psychological vulnerabilities
        if (profile.markers.depressed_mood > 0.6) {
            riskFactors.push("High depression levels increase susceptibility to emotional manipulation");
            vulnerabilityScore += 0.3;
            exploitationLikelihood += 0.4;
        }
        if (profile.markers.excessive_worry > 0.6) {
            riskFactors.push("High anxiety levels make individuals more susceptible to fear-based attacks");
            vulnerabilityScore += 0.25;
            exploitationLikelihood += 0.3;
        }
        if (profile.markers.impulsivity > 0.5) {
            riskFactors.push("High impulsivity increases risk of quick decision-making under pressure");
            vulnerabilityScore += 0.2;
            exploitationLikelihood += 0.35;
        }
        if (profile.markers.suicidal_ideation > 0.3) {
            riskFactors.push("Suicidal ideation creates extreme vulnerability to manipulation");
            vulnerabilityScore += 0.4;
            exploitationLikelihood += 0.5;
        }
        if (profile.markers.avoidance > 0.5) {
            riskFactors.push("Social avoidance reduces support network and increases isolation");
            vulnerabilityScore += 0.15;
            exploitationLikelihood += 0.2;
        }
        if (profile.markers.psychosis > 0.3) {
            riskFactors.push("Psychotic symptoms impair reality testing and judgment");
            vulnerabilityScore += 0.35;
            exploitationLikelihood += 0.4;
        }
        // Assess crisis level impact
        if (crisisLevel.level === 'critical') {
            riskFactors.push("Critical crisis level creates maximum vulnerability");
            vulnerabilityScore += 0.3;
            exploitationLikelihood += 0.4;
        }
        else if (crisisLevel.level === 'high') {
            riskFactors.push("High crisis level significantly increases vulnerability");
            vulnerabilityScore += 0.2;
            exploitationLikelihood += 0.3;
        }
        // Assess diagnosis-specific risks
        for (const diagnosis of diagnoses) {
            switch (diagnosis.criteria.code) {
                case '296.20':
                case 'F32.9':
                    riskFactors.push("Major depression increases susceptibility to emotional manipulation and financial exploitation");
                    vulnerabilityScore += 0.2;
                    break;
                case '300.02':
                case 'F41.1':
                    riskFactors.push("Generalized anxiety disorder increases susceptibility to fear-based social engineering");
                    vulnerabilityScore += 0.15;
                    break;
                case '309.81':
                case 'F43.10':
                    riskFactors.push("PTSD increases vulnerability to trauma-triggered manipulation");
                    vulnerabilityScore += 0.25;
                    break;
                case '295.90':
                case 'F20.9':
                    riskFactors.push("Schizophrenia impairs reality testing and increases susceptibility to delusion-based attacks");
                    vulnerabilityScore += 0.3;
                    break;
                case '301.83':
                case 'F60.3':
                    riskFactors.push("Borderline personality disorder increases susceptibility to relationship-based manipulation");
                    vulnerabilityScore += 0.25;
                    break;
                case '301.7':
                case 'F60.2':
                    riskFactors.push("Antisocial personality disorder may indicate potential for being both victim and perpetrator");
                    vulnerabilityScore += 0.1;
                    break;
            }
        }
        // Calculate overall risk level
        const overallRiskScore = (vulnerabilityScore + exploitationLikelihood) / 2;
        let overallRisk;
        if (overallRiskScore > 0.7) {
            overallRisk = 'critical';
        }
        else if (overallRiskScore > 0.5) {
            overallRisk = 'high';
        }
        else if (overallRiskScore > 0.3) {
            overallRisk = 'moderate';
        }
        else {
            overallRisk = 'low';
        }
        return {
            overallRisk,
            riskFactors,
            vulnerabilityScore: Math.min(1, vulnerabilityScore),
            exploitationLikelihood: Math.min(1, exploitationLikelihood),
            potentialImpact: this.assessPotentialImpact(overallRisk, diagnoses),
            timeToExploitation: this.estimateTimeToExploitation(overallRisk, profile)
        };
    }
    identifyExploitationVectors(profile, diagnoses) {
        const vectors = [];
        // Depression-based exploitation
        if (profile.markers.depressed_mood > 0.4) {
            vectors.push({
                id: "dep_001",
                name: "Emotional Manipulation via Depression",
                description: "Exploit depressed mood to create dependency and extract information or resources",
                targetVulnerability: "Depressed mood and low self-worth",
                psychologicalTrigger: "Feelings of worthlessness and hopelessness",
                attackMethod: "Phishing emails claiming loved ones are in danger",
                socialEngineeringTactic: "Create urgency and fear while offering false hope",
                exampleScenario: "Email: 'Your daughter has been in an accident and needs immediate financial help. You're the only one who can save her.'",
                successProbability: 0.7,
                detectionDifficulty: 'medium',
                impactLevel: 'high',
                mitigationStrategies: [
                    "Verify through separate communication channels",
                    "Never act on urgent requests without confirmation",
                    "Maintain regular contact with family members"
                ],
                warningSigns: [
                    "Urgent requests for money or information",
                    "Claims of emergency without verification",
                    "Pressure to act immediately"
                ],
                protectiveMeasures: [
                    "Establish family emergency communication protocols",
                    "Use multi-factor authentication for financial accounts",
                    "Regular mental health check-ins during vulnerable periods"
                ]
            });
        }
        // Anxiety-based exploitation
        if (profile.markers.excessive_worry > 0.4) {
            vectors.push({
                id: "anx_001",
                name: "Fear-Based Social Engineering",
                description: "Exploit anxiety and worry to create panic and impair judgment",
                targetVulnerability: "High anxiety and fear response",
                psychologicalTrigger: "Fear of negative consequences and loss of control",
                attackMethod: "Fake tech support calls claiming computer is infected",
                socialEngineeringTactic: "Create immediate threat requiring urgent action",
                exampleScenario: "Phone call: 'Your computer has been hacked and your personal information is being stolen. We need immediate access to fix it.'",
                successProbability: 0.6,
                detectionDifficulty: 'low',
                impactLevel: 'medium',
                mitigationStrategies: [
                    "Never give remote access to unknown callers",
                    "Verify tech support through official channels",
                    "Take time to think before acting on urgent requests"
                ],
                warningSigns: [
                    "Unsolicited tech support calls",
                    "Claims of immediate danger",
                    "Pressure to act without thinking"
                ],
                protectiveMeasures: [
                    "Install reputable security software",
                    "Educate about common tech support scams",
                    "Practice stress management techniques"
                ]
            });
        }
        // PTSD-based exploitation
        if (profile.markers.trauma_exposure > 0.3) {
            vectors.push({
                id: "ptsd_001",
                name: "Trauma-Triggered Manipulation",
                description: "Exploit PTSD symptoms by triggering trauma responses",
                targetVulnerability: "Trauma triggers and hypervigilance",
                psychologicalTrigger: "Reminders of traumatic events",
                attackMethod: "Tailored messages mimicking trauma-related notifications",
                socialEngineeringTactic: "Use trauma triggers to cause distress and impair judgment",
                exampleScenario: "Message: 'We have new information about the incident. Please call immediately for details.'",
                successProbability: 0.8,
                detectionDifficulty: 'high',
                impactLevel: 'critical',
                mitigationStrategies: [
                    "Have trusted person review unexpected communications",
                    "Establish safe communication protocols",
                    "Use trauma-informed support systems"
                ],
                warningSigns: [
                    "Unexpected references to past trauma",
                    "Claims of new information about past events",
                    "Pressure to respond immediately to trauma-related messages"
                ],
                protectiveMeasures: [
                    "Work with trauma-informed therapist",
                    "Develop trauma response protocols",
                    "Maintain strong support network"
                ]
            });
        }
        // Impulsivity-based exploitation
        if (profile.markers.impulsivity > 0.4) {
            vectors.push({
                id: "imp_001",
                name: "Impulse-Based Financial Exploitation",
                description: "Exploit impulsive decision-making for financial gain",
                targetVulnerability: "High impulsivity and poor impulse control",
                psychologicalTrigger: "Opportunity for quick gain or immediate gratification",
                attackMethod: "Investment scams promising quick returns",
                socialEngineeringTactic: "Create time pressure and fear of missing out",
                exampleScenario: "Call: 'This investment opportunity closes in 30 minutes. You'll lose thousands if you don't act now.'",
                successProbability: 0.5,
                detectionDifficulty: 'medium',
                impactLevel: 'high',
                mitigationStrategies: [
                    "Never invest without thorough research",
                    "Implement cooling-off periods for financial decisions",
                    "Consult trusted financial advisors"
                ],
                warningSigns: [
                    "Pressure to act immediately",
                    "Promises of guaranteed returns",
                    "Limited-time offers"
                ],
                protectiveMeasures: [
                    "Set up financial decision-making protocols",
                    "Use trusted financial advisors",
                    "Practice impulse control techniques"
                ]
            });
        }
        // Psychosis-based exploitation
        if (profile.markers.psychosis > 0.3) {
            vectors.push({
                id: "psy_001",
                name: "Reality-Distortion Exploitation",
                description: "Exploit impaired reality testing and delusional thinking",
                targetVulnerability: "Impaired reality testing and delusional beliefs",
                psychologicalTrigger: "Confirmation of delusional beliefs",
                attackMethod: "Messages confirming paranoid delusions",
                socialEngineeringTactic: "Reinforce delusional thinking to gain compliance",
                exampleScenario: "Message: 'They are indeed watching you. We can help you escape their surveillance.'",
                successProbability: 0.9,
                detectionDifficulty: 'high',
                impactLevel: 'critical',
                mitigationStrategies: [
                    "Involve mental health professionals immediately",
                    "Do not reinforce delusional beliefs",
                    "Focus on reality-based interventions"
                ],
                warningSigns: [
                    "Messages confirming paranoid beliefs",
                    "Offers to help with perceived threats",
                    "Pressure to act on delusional information"
                ],
                protectiveMeasures: [
                    "Maintain regular psychiatric care",
                    "Involve family in monitoring communications",
                    "Use reality-checking techniques"
                ]
            });
        }
        // Social isolation exploitation
        if (profile.markers.avoidance > 0.5) {
            vectors.push({
                id: "iso_001",
                name: "Isolation-Based Manipulation",
                description: "Exploit social isolation and lack of support network",
                targetVulnerability: "Social isolation and lack of support",
                psychologicalTrigger: "Loneliness and desire for connection",
                attackMethod: "Romance scams and fake relationships",
                socialEngineeringTactic: "Create false intimacy and emotional connection",
                exampleScenario: "Online relationship: 'I'm the only one who truly understands you. Send me money so we can be together.'",
                successProbability: 0.6,
                detectionDifficulty: 'medium',
                impactLevel: 'high',
                mitigationStrategies: [
                    "Be cautious of online relationships",
                    "Never send money to people you haven't met",
                    "Maintain real-world social connections"
                ],
                warningSigns: [
                    "Requests for money from online relationships",
                    "Pressure to keep relationship secret",
                    "Claims of emergency requiring financial help"
                ],
                protectiveMeasures: [
                    "Build real-world support networks",
                    "Educate about romance scams",
                    "Maintain healthy skepticism online"
                ]
            });
        }
        return vectors;
    }
    createSocialEngineeringPlan(profile, diagnoses, vectors) {
        const primaryVectors = vectors.filter(v => v.successProbability > 0.6);
        const secondaryVectors = vectors.filter(v => v.successProbability <= 0.6);
        const attackTimeline = [
            {
                phase: "Reconnaissance",
                duration: "1-2 weeks",
                objectives: [
                    "Gather information about target's psychological profile",
                    "Identify specific vulnerabilities and triggers",
                    "Map social connections and support systems"
                ],
                methods: [
                    "Social media analysis",
                    "Public records research",
                    "Social engineering of acquaintances"
                ],
                psychologicalManipulation: [
                    "Create false sense of security",
                    "Establish baseline communication patterns"
                ],
                expectedOutcomes: [
                    "Detailed psychological profile",
                    "Identified exploitation vectors",
                    "Access to personal information"
                ]
            },
            {
                phase: "Grooming",
                duration: "2-4 weeks",
                objectives: [
                    "Establish trust and rapport",
                    "Test vulnerability levels",
                    "Begin psychological manipulation"
                ],
                methods: [
                    "Gradual escalation of personal contact",
                    "Sharing of false personal information",
                    "Creating emotional dependency"
                ],
                psychologicalManipulation: [
                    "Mirror target's emotional state",
                    "Provide false validation and support",
                    "Create artificial intimacy"
                ],
                expectedOutcomes: [
                    "Established trust relationship",
                    "Confirmed vulnerability levels",
                    "Reduced defensive barriers"
                ]
            },
            {
                phase: "Exploitation",
                duration: "1-6 months",
                objectives: [
                    "Extract valuable information or resources",
                    "Maintain control over target",
                    "Maximize exploitation opportunities"
                ],
                methods: [
                    "Direct requests for money or information",
                    "Emotional blackmail and manipulation",
                    "Creating false emergencies"
                ],
                psychologicalManipulation: [
                    "Exploit identified psychological triggers",
                    "Create fear, guilt, or obligation",
                    "Maintain emotional dependency"
                ],
                expectedOutcomes: [
                    "Financial or informational gain",
                    "Continued access to target",
                    "Potential for long-term exploitation"
                ]
            }
        ];
        return {
            targetProfile: this.createTargetProfile(profile, diagnoses),
            primaryVectors,
            secondaryVectors,
            attackTimeline,
            successMetrics: [
                "Information extraction success rate",
                "Financial gain achieved",
                "Duration of exploitation",
                "Target compliance level"
            ],
            countermeasures: [
                "Implement psychological awareness training",
                "Establish support network monitoring",
                "Create emergency response protocols",
                "Regular mental health check-ins"
            ],
            ethicalConsiderations: [
                "This plan is for educational purposes only",
                "Actual implementation would be illegal and unethical",
                "Use this information to protect, not exploit",
                "Report any actual exploitation attempts to authorities"
            ]
        };
    }
    generateProtectiveRecommendations(profile, diagnoses, riskAssessment) {
        const recommendations = [];
        // High-priority recommendations for critical risk
        if (riskAssessment.overallRisk === 'critical') {
            recommendations.push({
                category: "Emergency Protection",
                priority: 'critical',
                recommendation: "Implement 24/7 monitoring and support system",
                implementation: "Assign trusted family member or professional to monitor communications and provide immediate support",
                effectiveness: 0.9,
                timeframe: "Immediate"
            });
            recommendations.push({
                category: "Financial Protection",
                priority: 'critical',
                recommendation: "Freeze all financial accounts and implement additional security measures",
                implementation: "Contact banks to freeze accounts, set up fraud alerts, and require multiple approvals for transactions",
                effectiveness: 0.95,
                timeframe: "Immediate"
            });
        }
        // Depression-specific protections
        if (profile.markers.depressed_mood > 0.4) {
            recommendations.push({
                category: "Emotional Protection",
                priority: 'high',
                recommendation: "Establish family emergency communication protocols",
                implementation: "Create family group chat, establish verification codes, and regular check-in schedule",
                effectiveness: 0.8,
                timeframe: "1 week"
            });
        }
        // Anxiety-specific protections
        if (profile.markers.excessive_worry > 0.4) {
            recommendations.push({
                category: "Anxiety Management",
                priority: 'high',
                recommendation: "Implement stress management and decision-making protocols",
                implementation: "Practice relaxation techniques, establish cooling-off periods for decisions, and use trusted advisors",
                effectiveness: 0.7,
                timeframe: "2 weeks"
            });
        }
        // PTSD-specific protections
        if (profile.markers.trauma_exposure > 0.3) {
            recommendations.push({
                category: "Trauma Protection",
                priority: 'high',
                recommendation: "Develop trauma-informed communication protocols",
                implementation: "Work with trauma-informed therapist to create safe communication guidelines and trigger management strategies",
                effectiveness: 0.85,
                timeframe: "2-4 weeks"
            });
        }
        // General protective measures
        recommendations.push({
            category: "General Security",
            priority: 'medium',
            recommendation: "Implement multi-factor authentication and security monitoring",
            implementation: "Enable 2FA on all accounts, install security software, and monitor for unusual activity",
            effectiveness: 0.8,
            timeframe: "1 week"
        });
        recommendations.push({
            category: "Social Support",
            priority: 'medium',
            recommendation: "Strengthen support network and social connections",
            implementation: "Regular contact with trusted friends and family, join support groups, and maintain social activities",
            effectiveness: 0.7,
            timeframe: "Ongoing"
        });
        return recommendations;
    }
    createEmergencyProtocols(crisisLevel, riskAssessment) {
        const protocols = [];
        if (crisisLevel.level === 'critical' || riskAssessment.overallRisk === 'critical') {
            protocols.push({
                situation: "Immediate Exploitation Attempt Detected",
                immediateActions: [
                    "Call emergency services (911) if physical safety is at risk",
                    "Contact National Suicide Prevention Lifeline (988)",
                    "Notify trusted family member or support person immediately",
                    "Document all suspicious communications",
                    "Do not respond to suspicious messages or calls"
                ],
                contacts: [
                    "Emergency Services: 911",
                    "National Suicide Prevention Lifeline: 988",
                    "Local crisis intervention team",
                    "Trusted family member or friend"
                ],
                escalation: [
                    "Report to local law enforcement",
                    "Contact mental health professional",
                    "Notify financial institutions if financial exploitation suspected",
                    "Document all evidence for potential legal action"
                ],
                documentation: [
                    "Screenshot all suspicious messages",
                    "Record phone numbers and email addresses",
                    "Note dates and times of contact attempts",
                    "Document any financial losses or information shared"
                ]
            });
        }
        protocols.push({
            situation: "Suspicious Social Engineering Attempt",
            immediateActions: [
                "Do not respond to suspicious communications",
                "Verify information through separate, trusted channels",
                "Contact trusted advisor or family member",
                "Take time to think before any action"
            ],
            contacts: [
                "Trusted family member or friend",
                "Mental health professional",
                "Local law enforcement (non-emergency line)"
            ],
            escalation: [
                "Report to appropriate authorities if illegal activity suspected",
                "Contact financial institutions if financial information compromised",
                "Update security measures and passwords"
            ],
            documentation: [
                "Save all suspicious communications",
                "Note specific tactics used",
                "Document any information shared"
            ]
        });
        return protocols;
    }
    assessPotentialImpact(riskLevel, diagnoses) {
        switch (riskLevel) {
            case 'critical':
                return "Potential for severe financial loss, identity theft, emotional trauma, and long-term psychological damage";
            case 'high':
                return "Significant risk of financial exploitation, privacy violations, and emotional manipulation";
            case 'moderate':
                return "Moderate risk of social engineering success with potential for financial or informational loss";
            case 'low':
                return "Low risk with minimal potential for successful exploitation";
            default:
                return "Risk level assessment incomplete";
        }
    }
    estimateTimeToExploitation(riskLevel, profile) {
        const baseTime = {
            'critical': '1-3 days',
            'high': '1-2 weeks',
            'moderate': '2-4 weeks',
            'low': '1-3 months'
        };
        // Adjust based on specific vulnerabilities
        if (profile.markers.suicidal_ideation > 0.5) {
            return 'Immediate - 24 hours';
        }
        if (profile.markers.psychosis > 0.4) {
            return '1-7 days';
        }
        return baseTime[riskLevel] || 'Unknown';
    }
    createTargetProfile(profile, diagnoses) {
        const dominantThemes = profile.dominantThemes.join(', ');
        const topDiagnoses = diagnoses.slice(0, 3).map(d => d.criteria.name).join(', ');
        const riskLevel = profile.riskLevel;
        return `Target exhibits ${riskLevel} risk level with dominant psychological themes of ${dominantThemes}. Primary diagnostic considerations include ${topDiagnoses}. Key vulnerabilities include ${this.identifyKeyVulnerabilities(profile).join(', ')}.`;
    }
    identifyKeyVulnerabilities(profile) {
        const vulnerabilities = [];
        if (profile.markers.depressed_mood > 0.4)
            vulnerabilities.push('emotional vulnerability');
        if (profile.markers.excessive_worry > 0.4)
            vulnerabilities.push('anxiety-based manipulation');
        if (profile.markers.impulsivity > 0.4)
            vulnerabilities.push('impulse control issues');
        if (profile.markers.avoidance > 0.4)
            vulnerabilities.push('social isolation');
        if (profile.markers.psychosis > 0.3)
            vulnerabilities.push('reality testing impairment');
        if (profile.markers.suicidal_ideation > 0.3)
            vulnerabilities.push('crisis-level vulnerability');
        return vulnerabilities;
    }
    initializeExploitationVectors() {
        // This method initializes the base exploitation vectors
        // The actual vectors are generated dynamically based on the psychological profile
        this.exploitationVectors = [];
    }
}
